<script name="rbac/user/row" pi="a/Source" type="text/x-dot">
<tr>
<td>{{! it.name }}</td>
<td>{{! it.login }}</td>
<td>{{! it.role_name }}</td>
<td><button pi="a/Pager/Dialog" id="{{! it.id }}" class="btn btn-small" msg="tbody@reload" prefix="rbac/user" data-id="{{! it.id }}">Править</button></td>
</tr>
</script>

<script name="rbac/user/option" pi="a/Source" type="text/x-dot">
<div pi="a/Template" name="h-input" data-group="options" data-fname="{{! it.o.caption }}" data-name="{{! it.o.name }}" data-value="{{! it.o.value }}"></div>
</script>

<script name="rbac/user/edit" pi="a/Source" type="text/x-dot">
<div title="Пользователь" data-width="500">
   <form method="POST" class="form-horizontal">

   <div class="control-group">
      <div pi="a/Template" name="h-input" data-fname="Имя" data-name="name" data-value="{{! it.o.name }}"></div>
      <div pi="a/Template" name="h-input" data-fname="Логин" data-name="login" data-value="{{! it.o.login }}"></div>
      <div pi="a/Template" name="h-input" data-fname="Пароль" data-name="password" data-value="{{! it.o.password }}"></div>
      <div pi="a/Template" name="h-input-typeahead" data-class="user-options" data-fname="Роль" data-uri="/rbac/role/complete_pair" data-name="role" data-value="{{! it.o.role_name }}" data-item="{{! it.o.role_id }}" data-item_map="role_id" data-target="#options"></div>
      <input class="form user-options" type="hidden" name="id" value="{{! it.o.id }}">
   </div>

   <div id="options" class="control-group" pi="a/List" uri="rbac/user/option/list" row="rbac/user/option" args=".user-options"></div>

   <button pi="a/Form" el=".form" msg="#{{! it.o.id }}[prefix='rbac/user']@save" class="btn">Сохранить</button>
   {{? it.o.id }}
   <button pi="a/Button" class="btn" msg="#{{! it.o.id }}[prefix='rbac/user']@delete" data-id="{{! it.o.id }}">Удалить</button>
   {{?}}

   </form>
</div>
</script>

<table class="table table-striped">
<caption pi="a/Template" replace name="table/caption" data-name="Пользователи" data-prefix="rbac/user"></caption>
<thead>
<tr>
   <th>Имя</th>
   <th>Логин</th>
   <th>Роль</th>
   <th></th>
</tr>
</thead>
<tbody pi="a/Pager" uri="/rbac/user/table" row="rbac/user/row" msg=".pagination@pager/load" filter=".filter">
</tbody>
</table>
